<script type="text/ng-template" id="colHeaderCheckBox.html">
</script>
<div class="popupWait hide"></div>
<div class="loadingImage hide" id="popupWaitLoadingImage">
    <a title="Matter Center Home" id="mcIcon" href="/sitepages/MatterCenterHome.aspx" target="_parent">
        <img title="Matter Center" src="../Images/WindowsLoadingFast.GIF" alt="Matter Center" />
    </a>
</div>
<div class="popupContainerBackground hide"></div>
<div id="mainDivContainer" ng-click="vm.closealldrops()">
    <div class="matterPopup"></div>
    <div class="documentPopup"></div>
    <div class="clear"></div>
    <!--Start Pop up conatins for documents to send documents to one drive, send email etc-->
    <div class="popUpContainer hide">
        <header class="popUpHeader">
            <div class="popUpHeaderTitle popUpFloatLeft"></div>
            <div class="notificationContainerForPopup"></div>
            <img class="mailCartCloseIcon" alt="Close" src="../Images/close-666.png" title="Close" />
        </header>
        <div id="PopupBody">
            <div class="selectMailFormat">
                <div class="sendEmailOptions sendToOneDriveOption" onclick="sendToBriefcase();">
                    <img class="mailCartLogo" src="../Images/my-briefcase-666.png" alt="Send to My OneDrive for Business" title="Send to My OneDrive" />
                    <div title="Send to My OneDrive for Business" class="inlineValues">Send to My OneDrive for Business</div>
                </div>
                <div class="sendEmailOptions emailAttachmentOption" onclick="downloadEmail(true);">
                    <img class="mailCartLogo" src="../Images/attach_666_27X27.png" alt="Email as attachment" title="Email as attachment" /><div title="Email as attachment" class="inlineValues">Email as attachment</div>
                </div>
                <div class="sendEmailOptions emailLinkOption" onclick="downloadEmail(false);">
                    <img class="mailCartLogo" src="../Images/link-666.png" alt="Email as link" title="Email as link" /><div title="Email as link" class="inlineValues">Email as link</div>
                </div>
            </div>
            <div class="popUpBody popUpFloatLeft">
                <div class="checkOutPopup">
                    <div class="checkOutPopupPointer"></div>
                    <div class="checkOutPopupData">
                        <div class="checkOutMetadata marginTop10"></div>
                    </div>
                </div>
                <ul class="emailDocumentNames"></ul>
                <div class='pinLoadingImage' id='mailCartLoadingImage'>
                    <img src='/Images/WindowsLoadingFast.GIF' title='Loading' class='LoadingImage' alt='Loading...' />
                </div>
            </div>
        </div>
    </div>
    <!--End Pop up conatins for documents to send documents to one drive, send email etc-->
    <div class="matterCenterHeaderBackground hide"></div>
    <!--Main dashboard content-->
    <div id="contentDiv">
        <header class="commonContent" id="matterCenterHeader">
            <div class="floatLeft" id="hamburgerConatiner">
                <img title="View links" class="headerActions" id="openHamburger" alt="" src="../Images/MC_homepage_Hamburger.png" data-hamburger="0">
            </div>
            <div class="closeIcon">
                <img title="Close" class="headerActions hide" id="closeHamburger" alt="" src="../Images/MC_Navigation_Close_icon_60px_X_60px.png" data-hamburger="1">
            </div>
            <div class="floatLeft" id="matterCenterHomeText">
                <img title="Matter Center" class="floatLeft" id="matterCenterHome" alt="" src="../Images/MC_homepage_Logo.png">
                <div class="floatRight">
                    <div class="upperSubText">Matter Center</div>
                    <div class="lowerSubText">for Office 365</div>
                </div>
            </div>
            <div class="searchBox">
                <input id="searchText" type="text" placeholder="Search SharePoint">
                <div id="searchLink">
                    <img title="Search" class="searchIcon" alt="search" src="../Images/search-15x15-666.png">
                </div>
            </div>
            <div class="hide" id="headerFlyout" >
                <div class="switchAppRow headerLinks selected" id="searchMatterTab" data-attr="Matters"><span title="Matters">Matters</span></div>
                <div class="switchAppRow headerLinks" id="searchDocumentTab" data-attr="Documents"><span title="Documents">Documents</span></div>
                <div class="headerLinks"><a id="settingsLink" onclick="closeHamburgerMenu();" href="https://msmatter.sharepoint.com/SitePages/Settings.aspx" target="_parent"><span title="Settings">Settings</span></a></div>
            </div>
        </header>
        <div class="row searchdashboard">
            <div class="col-xs-9">
                <div class="input-group">
                    <input type="text" ng-model="vm.searchText" placeholder="Search by document name, document ID, or keyword" 
                           uib-typeahead="matterDataList.matterName + ' ('+ matterDataList.matterID + ')' for matterDataList in vm.searchMatters($viewValue)" 
                           typeahead-loading="loadingLocations" typeahead-no-results="noResults" typeahead-on-select='vm.typeheadselect($item, $model)' class="form-control">
                    <span class="input-group-addon cursor" id="basic-addon1" ng-click="vm.searchByTerm()"><i class="glyphicon glyphicon-search"></i></span>
                </div>
            </div>
            <div class="col-xs-3 pad0">
                <img title="Advanced search" style="display: inline;" type='button' ng-if="vm.downwarddrop" ng-click="vm.showupward($event)" data-toggle='dropdown' alt="Drop Down" src="../Images/downward-advanced-search-29x29-666.png">
                <img title="Advanced search" id="filterSearchDown" ng-if="vm.upwarddrop" ng-click="vm.showdownward($event)" alt="Drop Down" src="../Images/upward-advanced-search-29x29-666.png">
            </div>
            <div class="col-xs-12">
                <i ng-show="loadingLocations" class="glyphicon glyphicon-refresh"></i>
                <!--<div ng-show="noResults">
                    <i class="glyphicon glyphicon-remove"></i> No Results Found
                </div>-->
            </div>
            <div class="col-xs-9 dashboarddrop" ng-click='vm.hideinnerdrop($event)' ng-if="vm.searchdrop">
                <div class="col-xs-12 dashboarddropinner">
                    <!--Start Client Selection Dropdown-->
                    <div class="row">
                        <div class="col-xs-12 col-sm-2 pull-left pad15">Clients</div>
                        <div class="col-xs-12 col-sm-7 pull-left pad10">
                            <div class="input-group">
                                <input type="text" value="{{vm.selectedClients}}" placeholder="Enter or select a client" class="form-control">
                                <span class="input-group-addon cursor" id="basic-addon1"
                                      ng-click="vm.showClientDrop($event)"><img src='../images/icon-combobox.png' /></span>
                            </div>
                        </div>
                        <div class="col-xs-12 col-sm-1 pull-left pad10 lazyLoading" ng-hide="vm.lazyloaderclient" style="position:unset !important">
                            <img src="../Images/WindowsLoadingFast.GIF" alt="Loading..." title="Loading..." />
                        </div>
                    </div>
                    <div class="col-xs-12 " ng-if="vm.clientdrop" ng-click="$event.stopPropagation();">
                        <div class="row ">
                            <div class="col-xs-9 col-sm-7 clientdropinner refinerClient">
                                <div class="col-xs-12 col-sm-5 col-md-2"><a class="btn btn-link" ng-click="vm.checkAll(true, 'client',$event)">Select All</a> </div>
                                <div class="col-xs-12 col-sm-5 col-md-2"><a class="btn btn-link" ng-click="vm.checkAll(false, 'client',$event)">Select None</a></div>
                                <div class="col-xs-12 refinerWrapper" ng-repeat="client in vm.clients" ng-click="$event.stopPropagation();">
                                    <input type="checkbox"  ng-model="client.Selected" /> <span>{{client.name}}</span>
                                </div>
                                <div class="row">
                                    <div class="col-xs-3">
                                        <div class="filterOkButton"><div class="dashboardSearch" ng-click="vm.filterSearchOK('client')">Ok</div></div>
                                    </div>
                                    <div class="col-xs-3">
                                        <div class="filterOkButton"><div class="dashboardSearch" ng-click="vm.filterSearchCancel()">Cancel</div></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!--End Client Search Selection Down-->
                    <!--Start Practice Group Selection Dropdown-->
                    <div class="row">
                        <div class="col-xs-12 col-sm-2 pull-left pad15">Practice Group</div>
                        <div class="col-xs-12 col-sm-7 pull-left pad10">
                            <div class="input-group">
                                <input type="text" value="{{vm.selectedPGs}}" placeholder="Enter or select a practice group" class="form-control">
                                <span class="input-group-addon cursor" id="basic-addon1"
                                      ng-click="vm.showPracticegroupDrop($event)"><img src='../images/icon-combobox.png' /></span>
                            </div>
                        </div>
                        <div class="col-xs-12 col-sm-1 pull-left pad10 lazyLoading" ng-hide="vm.lazyloaderpg" style="position:unset !important">
                            <img src="../Images/WindowsLoadingFast.GIF" alt="Loading..." title="Loading..." />
                        </div>
                    </div>
                    <div class="col-xs-12 " ng-if="vm.pgdrop" ng-click="$event.stopPropagation();">
                        <div class="row ">
                            <div class="col-xs-9 col-sm-7 clientdropinner refinerClient">
                                <div class="col-xs-12 col-sm-5 col-md-2"><a class="btn btn-link" ng-click="vm.checkAll(true, 'pg',$event)">Select All</a> </div>
                                <div class="col-xs-12 col-sm-5 col-md-2"><a class="btn btn-link" ng-click="vm.checkAll(false, 'pg',$event)">Select None</a></div>
                                <div class="col-xs-12 refinerWrapper" ng-repeat="pg in vm.practiceGroups"  ng-click="$event.stopPropagation();">
                                    <input type="checkbox" ng-model="pg.Selected" /> <span>{{pg.termName}}</span>
                                </div>
                                <div class="row">
                                    <div class="col-xs-3">
                                        <div class="filterOkButton"><div class="dashboardSearch" ng-click="vm.filterSearchOK('pg')">Ok</div></div>
                                    </div>
                                    <div class="col-xs-3">
                                        <div class="filterOkButton"><div class="dashboardSearch" ng-click="vm.filterSearchCancel()">Cancel</div></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!--End Practive Group Selection Dropdown-->
                    <!--Start AOL Selection Dropdown-->
                    <div class="row">
                        <div class="col-xs-12 col-sm-2 pull-left pad15">Area of Law</div>
                        <div class="col-xs-12 col-sm-7 pull-left pad10">
                            <div class="input-group">
                                <input type="text" value="{{vm.selectedAOLs}}" placeholder="Enter or select an area of law" class="form-control">
                                <span class="input-group-addon cursor" id="basic-addon1"
                                      ng-click="vm.showAreaofLawDrop($event)"><img src='../images/icon-combobox.png' /></span>
                            </div>
                        </div>
                        <div class="col-xs-12 col-sm-1 pull-left pad10 lazyLoading" ng-hide="vm.lazyloaderaol" style="position:unset !important">
                            <img src="../Images/WindowsLoadingFast.GIF" alt="Loading..." title="Loading..." />
                        </div>
                    </div>
                    <div class="col-xs-12" ng-if="vm.aoldrop" ng-click="$event.stopPropagation();">
                        <div class="row ">
                            <div class="col-xs-9 col-sm-7 clientdropinner refinerClient">
                                <div class="col-xs-12 col-sm-5 col-md-2"><a class="btn btn-link" ng-click="vm.checkAll(true, 'aol',$event)">Select All</a> </div>
                                <div class="col-xs-12 col-sm-5 col-md-2"><a class="btn btn-link" ng-click="vm.checkAll(false, 'aol',$event)">Select None</a></div>
                                <div class="col-xs-12 refinerWrapper" ng-repeat="aol in vm.aolTerms"  ng-click="$event.stopPropagation();">
                                    <input type="checkbox" ng-model="aol.Selected" /> <span>{{aol.termName}}</span>
                                </div>
                                <div class="row">
                                    <div class="col-xs-3">
                                        <div class="filterOkButton"><div class="dashboardSearch" ng-click="vm.filterSearchOK('aol')">Ok</div></div>
                                    </div>
                                    <div class="col-xs-3">
                                        <div class="filterOkButton"><div class="dashboardSearch" ng-click="vm.filterSearchCancel()">Cancel</div></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!--End AOL Selection Dropdown-->

                    <div class="row">
                        <div class="col-xs-12 col-sm-2 pull-left pad15">Date</div>
                        <div class="col-xs-12 col-sm-7 pull-left pad10">
                            <div class="row">
                                <div class="col-xs-6 col-sm-4">
                                    <div class='input-group'>
                                        <input type='text' placeholder='From' class='calendar form-control'
                                               uib-datepicker-popup='MM/dd/yyyy'
                                               ng-model='vm.startdate'
                                               is-open='vm.openedStartDate'
                                               datepicker-options='vm.dateOptions'
                                               ng-required='true' close-text='Close'
                                               alt-input-formats='altInputFormats' />
                                        <span class='input-group-btn'>
                                            <button type='button' class='btn btn-default' ng-click='vm.openStartDate()'><i class='glyphicon glyphicon-calendar'></i></button>
                                        </span>
                                    </div>
                                </div>
                                <div class="col-xs-6 col-sm-4">
                                    <div class='input-group'>
                                        <input type='text' placeholder='To' class='calendar form-control'
                                               uib-datepicker-popup='MM/dd/yyyy'
                                               ng-model='vm.enddate'
                                               is-open='vm.openedEndDate'
                                               datepicker-options='vm.enddateOptions'
                                               ng-required='true' close-text='Close'
                                               alt-input-formats='altInputFormats' />
                                        <span class='input-group-btn'>
                                            <button type='button' class='btn btn-default' ng-click='vm.openEndDate()'><i class='glyphicon glyphicon-calendar'></i></button>
                                        </span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-xs-5 col-sm-3 pad15">
                            <div id="filterAdvancedSearch" class="dashboardSearch" ng-click="vm.getSearchResults()">
                                Search
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-xs-12 padtop20">
                <ul class="nav nav-tabs" toggletab>
                    <li id="myMatters"><a href="#MyMatters" data-toggle="tab" ng-click="vm.myMatters()">My matters ({{vm.myMatterCount}})</a></li>
                    <li id="allMatters" class="active cursor"><a data-toggle="tab" ng-click="vm.search()">All matters ({{vm.allMatterCount}})</a></li>
                    <li id="pinMatters"><a href="#PinnedMatters" data-toggle="tab" ng-click="vm.getMatterPinned()">Pinned matters ({{vm.pinMatterCount}})</a></li>
                </ul>
            </div>
            <div class="col-xs-offset-9 col-xs-3 sortby">
                <div class="col-xs-offset-4 col-xs-8 text-right pad0">
                    <span>Sort by: </span>
                    <span>{{vm.sortbytext}}</span>
                    <img alt="Sort By" class="" ng-click="vm.showsortby($event)" title="Sort By" src="../Images/icon-combobox.png" />
                </div>
                <div class="col-xs-offset-7 col-xs-5" ng-if="vm.sortbydrop">
                    <ul>
                        <li ng-click="vm.sortyby('Relevant','None')">None</li>
                        <li ng-click="vm.sortyby('AlphabeticalUp','Alphabetical ↑')">Alphabetical ↑</li>
                        <li ng-click="vm.sortyby('AlphabeticalDown','Alphabetical ↓')">Alphabetical ↓</li>
                        <li ng-click="vm.sortyby('CreateddateUp','Created date ↑')">Created date ↑</li>
                        <li ng-click="vm.sortyby('CreateddateDown','Created date ↓')">Created date ↓</li>
                    </ul>
                </div>
            </div>
            <div class="col-xs-12">
                <div class="tab-content">                    
                    <div class="tab-pane active" id="mattersGrid" >
                        <div class="col-xs-12 pad0 padtop5" ng-if="vm.divuigrid">
                            <div class="" id="grid1" ui-grid="vm.matterGridOptions" ui-grid-exporter ui-grid-selection ui-grid-auto-resize></div>
                        </div>
                        <div class="col-xs-12 pad0 padtop5 text-center" ng-if="vm.nodata">
                            No results found.
                        </div>
                    </div>                    
                </div>

            </div>
        </div>
        <div class="jsonGridFooter" ng-if="vm.displaypagination && vm.totalrecords>0">
            <div ng-if="vm.totalrecords>6 && vm.first>2"> <img id="" ng-click="vm.prev()" class="first cur-pointer" src="../Images/pagination-back-Enabled.png"></div>
            <div ng-if="vm.totalrecords<6 || vm.first<2"><img id="grid_Grid_First" class="first click-disabled" src="../Images/pagination-back-disabled.png"></div>
            <div id="grid_Grid_ViewRecords" class="ViewRecordDiv moveToMiddle"><span class="PaginateSpan">{{vm.fromtopage}}</span></div>
            <div ng-if="vm.totalrecords<=6 || vm.last>=vm.totalrecords"><img id="grid_Grid_Next" class="next click-disabled" src="../Images/pagination-front-disabled.png"></div>
            <div ng-if="vm.totalrecords>6" ng-class="{'hide':vm.last>=vm.totalrecords}"><img title="Next" id="grid_Grid_Next" ng-click="vm.next()" class="next cur-pointer" active="0" src="../Images/pagination-front-Enabled.png"></div>

        </div>
        <div class="LeftContent">
            <div class="mailpopupContainerBackground hide"></div>
            <div class="appName hide">
                <div class="appLink">
                    <a>
                        <img alt="Matter Center" class="appImage" src="../Images/Portal_logo_png.png" />
                        <div class="appTitle"><span>Matter Center</span></div>
                        <div class="appTitleSmall"><span>for Office 365</span></div>
                    </a>
                </div>
            </div>           
            <div class="searchDocumentHeader">
                <div class="switchTab hide">
                    <div class="navDiv" onclick="changeNavigationTabs(this);">Search Results</div>
                </div>
            </div>  
            <div id="recentView">
                <div id="RecentDocumentContainer" class=""></div>
                <div id="recentMatters" class="hide">
                </div>
            </div>
        </div>
    </div>
    <!--Upload Modal Screen Start-->
    <div class="modal fade" id="UploadMatterModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg" style="width:100%">
            <div ng-if="vm.IsDupliacteDocument" class="notificationContainerForPopup" style="height: 80px;margin-left:0">


                <script type="text/ng-template" id="duplicateErrorDiv">
                    <div class="notification warningNotification" ng-show="duplicatefile.cancel!==null">
                        <img id="warningImg" draggable="false" alt="Warning Message" src="../Images/warning-message.png">
                        <div id="overWriteDocumentName">
                            <div ng-bind-html="duplicatefile.value"></div>


                        </div>
                        <div class="notificationResult hide"></div>
                        <div class="askForOverwrite">
                            <input ng-show="duplicatefile.contentCheck=='True'" type="button" title="Matter Center will compare all content and data associated with the two documents. Navigating away from this screen will cancel the content check." value="Perform content check" data-operation="contentCheck" ng-click="vm.localOverWriteDocument(duplicatefile,'contentCheck');vm.contentCheckNotification(duplicatefile,true);">
                            <input ng-show="duplicatefile.saveLatestVersion=='True'" title="The file will be saved as the latest version of the existing document that has same title. Matter Center will retain all prior versions of the document." id="overWriteYes"
                                   ng-click="vm.localOverWriteDocument(duplicatefile,'overwrite');" type="button" value="Save as latest version" data-operation="overwrite">
                            <input ng-show="duplicatefile.append==true" type='button' data-operation='append' title='The file will be saved as new, separate document with the current date and time added to the end of the file name.' value="Append date to file name and save" ng-click="vm.localOverWriteDocument(duplicatefile,'append')" />
                            <input ng-show="duplicatefile.cancel=='True'" title="This document will not be uploaded and you will return to the previous screen." id="overWriteNo"
                                   ng-click="vm.localOverWriteDocument(duplicatefile,'ignore');" type="button" value="Cancel upload" data-operation="ignore">
                            <div ng-show="duplicatefile.contentCheck=='contentCheck'" class='notificationCC'>
                                <img src="../Images/loadingcirclests16.gif" alt="" />Checking content  <input id='cancelCC' type='button' value='Cancel' ng-click='vm.abortContentCheck(duplicatefile,true)' />
                            </div>
                        </div>
                    </div>
                </script>

                <div ng-repeat="duplicatefile in vm.ducplicateSourceFile" ng-include="'duplicateErrorDiv'"></div>

            </div>

            <div class="modal-content">
                <div ng-show="vm.oUploadGlobal.successBanner" class="notification successNotification ms-font-weight-semibold successUpload">Upload complete.<span class="closeNotification" ng-click="vm.closeSuccessBanner()">x</span></div>
                <div class="row modalClose">
                    <img data-dismiss="modal" ng-click="vm.hideBreadCrumb()" class="pull-right" src="../../images/close-666.png" />
                </div>
                <div class="modal-body modelbodyContainer">
                    <div class='loadingprogressbar'>
                        <img ng-if="vm.isLoadingFromDesktopStarted" alt='Loading' class='attachmentListLoading' src='../images/loading_metro.gif' />
                    </div>
                    <div class="row margin0">
                        <div class="col-sm-10 pad0">
                            <div class="attachmentHeader marginBottom15">Drag and drop items to folders on the right</div>
                        </div>

                    </div>
                    <div class="row margin0">
                        <div class="col-sm-9 pull-left mailHeaderItems"><div>Items</div></div>
                        <div class="col-sm-3 pull-left mailHeaderFolders"><div></div>Folders</div>
                    </div>

                    <div class="row margin0">
                        <div class="col-sm-9 maildata">
                            <!--Content start to show mail attachment information-->
                            <div class="attachmentSection" ng-repeat="attachmentInfo in vm.allAttachmentDetails">
                                <div ng-if="vm.loadingAttachments" class='attachmentSection'><img alt='Loading' class='attachmentListLoading' src='../images/loading_metro.gif' /></div>
                                <div ng-if="attachmentInfo.isEmail" class="attachment">
                                    <div class="attachmentName mailName">
                                        <img title="Edit attachment name" class="editUploadIcon" id="{{attachmentInfo.counter}}editIcon" draggable="false"
                                             ng-click="vm.editAttachment(this, $event)" alt="Edit" src="../Images/edit-666.png">
                                        <img title="Save attachment name" class="saveUploadIcon hide" id="{{attachmentInfo.counter}}saveIcon" draggable="false"
                                             ng-click="vm.saveAttachment(this, $event)" alt="Save" src="../Images/save-666.png">
                                        <!--If the mail upload is success, show this div-->
                                        <div ng-if="vm.mailUpLoadSuccess" class="uploadSuccessStatus" id="{{attachmentInfo.counter}}attachment-Status">
                                            <img class="uploadSuccessStatus" alt="Uploaded successfully" src="/images/success-message.png">
                                        </div>
                                        <img class="attachIcon" id="{{attachmentInfo.counter}}attachIcon" alt="attachment icon" src="../Images/attach_icon-15x15_666.png">
                                        <input class="popupName editPopupContent hide ui-draggable" id="0attachmentText" type="text" maxlength="128">
                                        <div title="Test attachments"
                                             class="popupName ui-draggable"
                                             id="{{attachmentInfo.counter}}attachment"
                                             draggable
                                             data-isEmail="{{attachmentInfo.isEmail}}"
                                             data-attachmentid="{{attachmentInfo.attachmentId}}">{{attachmentInfo.attachmentFileName}}</div>
                                        <!--If the mail upload is success, show the folder name under which the email has been dropped-->
                                        <div ng-if="vm.mailUpLoadSuccess" title="{{vm.mailUploadedFolder}}" class="uploadSuccessMessage" id="{{attachmentInfo.counter}}attachment-Message">{{vm.mailUploadedFolder}}</div>
                                    </div>
                                </div>

                                <div ng-if="!attachmentInfo.isEmail" class="attachment">
                                    <div class="attachmentName">
                                        <img title="Edit attachment name" class="editUploadIcon" id="{{attachmentInfo.counter}}editIcon" draggable="false"
                                             ng-click="vm.editAttachment(this, $event)" alt="Edit" src="../Images/edit-666.png">
                                        <img title="Save attachment name" class="saveUploadIcon hide" id="{{attachmentInfo.counter}}saveIcon" draggable="false"
                                             ng-click="vm.saveAttachment(this, $event)" alt="Save" src="../Images/save-666.png">
                                        <div ng-if="vm.docUpLoadSuccess" class="uploadSuccessStatus" id="{{attachmentInfo.counter}}attachment-Status">
                                            <img class="uploadSuccessStatus" alt="Uploaded successfully" src="/images/success-message.png">
                                        </div>
                                        <!--If the attachment upload is success, show this div-->
                                        <img class="attachIcon" id="{{attachmentInfo.counter}}attachIcon" alt="attachment icon" src="../Images/attach_icon-15x15_666.png">
                                        <input class="popupName editPopupContent hide ui-draggable" id="{{attachmentInfo.counter}}attachmentText" type="text" maxlength="128">
                                        <div title="{{attachmentInfo.attachmentFileName}}"
                                             id="{{attachmentInfo.counter}}attachment"
                                             class="popupName ui-draggable"
                                             draggable
                                             data-contentType="{{attachmentInfo.contentType}}"
                                             data-size="{{attachmentInfo.size}}"
                                             data-isEmail="{{attachmentInfo.isEmail}}"
                                             data-attachmentid="{{attachmentInfo.attachmentId}}">{{attachmentInfo.attachmentFileName}}</div>
                                        <!--If the attachment upload is success, show the folder name under which the attachment has been dropped-->
                                        <div ng-if="vm.docUpLoadSuccess" title="{{vm.docUploadedFolder}}" class="uploadSuccessMessage" id="{{attachmentInfo.counter}}attachment-Message">{{vm.docUploadedFolder}}</div>
                                    </div>
                                </div>
                            </div>
                            <!--Content end to show mail attachment information-->
                            <!--Content start for showing the files which are uploaded from desktop-->
                            <div class="attachmentSection folderStructureContent">

                                <div ng-repeat="uploadedFile in vm.uploadedFiles" class="attachment">
                                    <div class="attachmentName mailName">
                                        <!--If the mail upload is success, show this div-->
                                        <div ng-if="!uploadedFile.isError" class="uploadSuccessStatus">
                                            <img class="uploadSuccessStatus" alt="Uploaded successfully" src="/images/success-message.png">
                                        </div>
                                        <img class="attachIcon" id="{{uploadedFile.counter}}attachIcon"
                                             alt="attachment icon" src="{{uploadedFile.documentIconUrl}}">
                                        <div title="Test attachments" class="popupName">{{uploadedFile.fileName}}</div>
                                        <!--If the mail upload is success, show the folder name under which the email has been dropped-->
                                        <div ng-if="!uploadedFile.isError" title="{{uploadedFile.dropFolder}}" class="uploadSuccessMessage">({{uploadedFile.dropFolder}})</div>
                                    </div>
                                </div>
                                <div ng-hide="vm.uploadedFiles.length || vm.allAttachmentDetails.length">
                                    <div title="Test attachments" class="popupName" style="margin-left:1%;">
                                        No files uploaded
                                    </div>
                                </div>
                            </div>
                            <!--Content end for showing the files which are uploaded from desktop-->

                            <!--<div ng-if="vm.allAttachmentDetails.length==0" class="noFilesUploaded">No files uploaded</div>-->
                        </div>
                        <div class="col-sm-3 folderContent">
                            <div id="breadcrumb" class="breadcrumb" ng-hide="breadcrumb">
                                <img alt="Root" ng-click="hideBreadCrumb()" id="rootLink" src="../Images/Return_Icon_23px_23px_666.png" title="<span class=&quot;content&quot;>cv vb</span>" draggable="false">
                                <div id="parentFolder" class="breadcrumbItem"></div>
                                <div id="breadcrumbSeparator"></div>
                                <div id="currentFolder" class="breadcrumbItem"></div>
                            </div>
                            <div class="folderStructureContent" showbreadcrumb ng-hide="foldercontent">
                                <script type="text/ng-template" id="folderTree">
                                    <div ng-if="child.parentURL!==null" class="treeNodes" ng-show="child.active" title="" droppable drop="handleDrop()" folder="child" data-foldername="{{child.url}}" data-parentname="{{child.parentURL}}" ng-click="vm.showSelectedFolderTree(child)">
                                        <img class="folderIcon" src="https://msmatter.sharepoint.com/_layouts/15/images/folder.gif" align="center" alt="Documents">
                                        {{child.name}}
                                    </div>
                                    <ul ng-if="child.children" style="margin-left:5px;">
                                        <li ng-repeat="child in child.children" data-foldername="{{child.url}}" data-parentname="{{child.parentURL}}" droppable drop="handleDrop()" folder="child" class="childNode" ng-include="'folderTree'">

                                        </li>
                                    </ul>
                                </script>

                                <ul>
                                    <li ng-repeat="child in vm.foldersList" ng-class='child.parentURL?"childNode":"parentNode"' data-foldername="{{child.url}}" data-parentname="{{child.parentURL}}" droppable drop="handleDrop()" folder="child" ng-include="'folderTree'" style="display: inline-block; width: 90%; padding:0;">

                                    </li>

                                    <!--<li ng-repeat="folder in vm.foldersList">
                                        <ul ng-repeat="child in folder.children">
                                            <li ng-if="child.parentURL" data-client="" data-foldername="{{child.url}}" data-parentname="{{child.parentURL}}" class="childNode"
                                                style="display: inline-block; width: 90%; padding:0;">
                                                <div class="treeNodes" title="Documents" droppable drop="handleDrop()" folder="folder" id="folder{{$index}}">
                                                    <img class="folderIcon" src="https://msmatter.sharepoint.com/_layouts/15/images/folder.gif" align="center" alt="Documents"
                                                         data-foldername="{{folder.url}}" data-parentname="{{folder.parentURL}}">
                                                    {{folder.name}}
                                                </div>
                                            </li>
                                        </ul>
                                    </li>-->
                                </ul>
                            </div>
                        </div>
                    </div>
                    <div class="row margin0 marginTop15">
                        <div class="pull-left"><img src="../../images/information-blue.png" /> You can also drag and drop files from your desktop.</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!--Upload Modal Screen Ends-->
 </div>
<div id="loadingImageContainer">
    <div class="lazyLoading" ng-hide="vm.lazyloaderdashboard">
        <img src="../Images/WindowsLoadingFast.GIF" alt="Loading..." title="Loading..." />
    </div>
</div>